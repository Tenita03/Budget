<!â€” Budget App Code â€”>
<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Paycheck Tracker â€“ Stable Base</title>

<style>
:root{
  --bg:#f3f4f6;
  --card:#ffffff;
  --text:#0f172a;
  --muted:#64748b;
  --line:#e5e7eb;
  --brand:#007aff;
  --danger:#fee2e2;
  --radius:16px;
  --shadow:0 10px 30px rgba(0,0,0,.06);
}

*{ box-sizing:border-box; }

body{
  margin:0;
  background:var(--bg);
  font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",system-ui,sans-serif;
  color:var(--text);
}

.wrap{
  max-width:900px;
  margin:auto;
  padding:16px;
}

.card{
  background:var(--card);
  border-radius:var(--radius);
  box-shadow:var(--shadow);
  padding:16px;
  margin-bottom:16px;
}

h2{
  margin:0 0 12px;
  font-size:18px;
}

.row{
  display:grid;
  grid-template-columns:1fr 1fr;
  gap:12px;
}

input, select, button{
  padding:10px;
  border-radius:10px;
  border:1px solid var(--line);
  font-size:15px;
}

button{
  background:var(--brand);
  color:#fff;
  border:none;
  cursor:pointer;
}

button.secondary{
  background:#94a3b8;
}

table{
  width:100%;
  border-collapse:collapse;
}

th, td{
  padding:8px;
  border-bottom:1px solid var(--line);
  text-align:left;
}

th{
  font-size:12px;
  color:var(--muted);
}

.remove{
  cursor:pointer;
  color:#94a3b8;
}

.remove:hover{
  color:#ef4444;
}

.kpi{
  display:flex;
  justify-content:space-between;
  align-items:center;
}

.kpi .value{
  font-size:28px;
  font-weight:800;
}

.locked *:not(#lockBtn){
  pointer-events:none;
  opacity:.6;
}

@media (max-width:480px){
  .row{ grid-template-columns:1fr; }
}
</style>
</head>

<body>
<div class="wrap" id="app">

<!-- HEADER -->
<div class="card">
  <div class="row">
    <select id="month"></select>
    <select id="year"></select>
  </div>
  <div class="row" style="margin-top:10px;">
    <input id="startingBalance" type="number" placeholder="Starting balance">
    <button id="lockBtn" class="secondary">ðŸ”“ Lock Month</button>
  </div>
</div>

<!-- REMAINING -->
<div class="card">
  <div class="kpi">
    <div>Remaining This Month</div>
    <div class="value" id="remaining">$0.00</div>
  </div>
</div>

<!-- INCOME -->
<div class="card">
  <h2>Income</h2>
  <table>
    <thead><tr><th>Source</th><th>Amount</th><th></th></tr></thead>
    <tbody id="income"></tbody>
  </table>
  <button id="addIncome">+ Add Income</button>
</div>

<!-- BILLS -->
<div class="card">
  <h2>Bills</h2>
  <table>
   <thead>
  <tr>
    <th>âœ”</th>
    <th>Name</th>
    <th>Amount</th>
    <th></th>
  </tr>
</thead>
    <tbody id="bills"></tbody>
  </table>
  <button id="addBill">+ Add Bill</button>
</div>

<!-- DEBT -->
<div class="card">
  <h2>Debt</h2>
  <table>
    <thead>
  <tr>
    <th>Debt</th>
    <th>Balance</th>
    <th>APR %</th>
    <th>Payment</th>
    <th>Extra</th>
    <th>Interest</th>
    <th>Principal</th>
    <th>New Balance</th>
    <th></th>
  </tr>
</thead>
    <tbody id="debt"></tbody>
  </table>
  <button id="addDebt">+ Add Debt</button>
</div>

</div>

<script>
/* ========= STABLE CORE ========= */

const $ = id => document.getElementById(id);
const money = n => `$${(Number(n)||0).toFixed(2)}`;

const monthSel = $("month");
const yearSel  = $("year");
const startBal = $("startingBalance");

const incomeT = $("income");
const billsT  = $("bills");
const debtT   = $("debt");

const remaining = $("remaining");
const lockBtn = $("lockBtn");
const app = $("app");

let locked = false;

/* Month / Year */
(() => {
  const now = new Date();
  for(let i=0;i<12;i++){
    monthSel.add(new Option(
      new Date(0,i).toLocaleString("default",{month:"long"}), i
    ));
  }
  for(let y=2024;y<2036;y++) yearSel.add(new Option(y,y));
  monthSel.value = now.getMonth();
  yearSel.value  = now.getFullYear();
})();

/* Rows */
function addRow(table, cells){
  const tr = document.createElement("tr");
  tr.innerHTML = cells + `<td><span class="remove">Ã—</span></td>`;
  tr.querySelector(".remove").onclick = () => {
    if(locked) return;
    tr.remove();
    update();
  };
  tr.querySelectorAll("input").forEach(i=>i.oninput=update);
  table.appendChild(tr);
}

$("addIncome").onclick = ()=>!locked && addRow(incomeT,
  `<td><input></td><td><input type="number"></td>`
);

$("addBill").onclick = ()=>!locked && addRow(billsT,
  `<td><input type="checkbox"></td>
   <td><input></td>
   <td><input type="number"></td>`
);

$("addDebt").onclick = ()=>!locked && addRow(debtT,
  `<td><input></td>
   <td><input type="number"></td>
   <td><input type="number"></td>
   <td><input type="number"></td>
   <td><input type="number"></td>
   <td>$0.00</td>
   <td>$0.00</td>
   <td>$0.00</td>`
);

/* Lock */
lockBtn.onclick = ()=>{
  locked = !locked;
  app.classList.toggle("locked",locked);
  lockBtn.textContent = locked ? "ðŸ”’ Unlock Month" : "ðŸ”“ Lock Month";
  save();
};

/* Calculate */
function sum(table){
  let t=0;
  table.querySelectorAll("tr").forEach(r=>{
    t += Number(r.children[1].querySelector("input").value)||0;
  });
  return t;
}

function updateDebtLinks(){
  const debtMap = {};
debtTable.querySelectorAll("tr").forEach(r=>{
  const name = r.children[0].querySelector("input").value;
  debtMap[name] = { pay: 0, extra: 0 };
});

billsTable.querySelectorAll("tr").forEach(r=>{
  const paid = r.children[0].querySelector("input").checked;
  const amt  = num(r.children[3].querySelector("input").value);
  const link = r.children[4].querySelector("select").value;
  const type = r.children[5].querySelector("select").value;

  if(!paid){
    bills += amt;
    r.children[6].textContent = money(amt);
  } else {
    r.children[6].textContent = money(0);

    if(link && debtMap[link]){
      type === "principal"
        ? debtMap[link].extra += amt
        : debtMap[link].pay   += amt;
    }
  }
});

function update(){
  const start = Number(startBal.value)||0;
  const income = sum(incomeT);
  const bills = sumUnpaidBills();
  const debt = calculateDebt();
  const rem = start + income - bills - debt;
  remaining.textContent = money(rem);
  save();
}

function sumUnpaidBills(){
  let t = 0;
  billsT.querySelectorAll("tr").forEach(r=>{
    const paid = r.children[0].querySelector("input").checked;
    const amt  = Number(r.children[2].querySelector("input").value)||0;
    if(!paid) t += amt;
    r.style.opacity = paid ? 0.45 : 1;
  });
  return t;
}

function calculateDebt(){
  let total = 0;

  debtT.querySelectorAll("tr").forEach(r=>{
    const bal   = Number(r.children[1].querySelector("input").value)||0;
    const apr   = Number(r.children[2].querySelector("input").value)||0;
    const pay   = Number(r.children[3].querySelector("input").value)||0;
    const extra = Number(r.children[4].querySelector("input").value)||0;

    const linkedPay   = debtMap[name]?.pay   || 0;
const linkedExtra = debtMap[name]?.extra || 0;

const interest = bal * (apr/100/12);
const principal =
  Math.max((pay + linkedPay) - interest, 0)
  + extra
  + linkedExtra;

const newBal = Math.max(bal - principal, 0);

    r.children[5].textContent = money(interest);
    r.children[6].textContent = money(principal);
    r.children[7].textContent = money(newBal);

    total += pay + extra;
debtOut += pay + extra + linkedPay + linkedExtra;
  });

  return total;
}
/* Save / Load */
function key(){
  return `stable-${yearSel.value}-${monthSel.value}`;
}

function save(){
  localStorage.setItem(key(), JSON.stringify({
    locked,
    start: startBal.value,
    income:[...incomeT.children].map(r=>r.children[1].querySelector("input").value),
    bills:[...billsT.children].map(r=>r.children[1].querySelector("input").value),
    debt:[...debtT.children].map(r=>r.children[1].querySelector("input").value)
  }));
}

function load(){
  const d = JSON.parse(localStorage.getItem(key())||"{}");
  locked = !!d.locked;
  app.classList.toggle("locked",locked);
  lockBtn.textContent = locked ? "ðŸ”’ Unlock Month" : "ðŸ”“ Lock Month";
  startBal.value = d.start||"";
  update();
}

monthSel.onchange = yearSel.onchange = load;
startBal.oninput = update;

load();
</script>
</body>
</html>